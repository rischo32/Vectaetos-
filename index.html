<!DOCTYPE html>
<html lang="sk">
<head>
<meta charset="UTF-8">
<title>VECTAETOS — Epistemic Field</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --bg:#000;
  --fg:#eaeaea;
  --border:#333;
  --font:system-ui,-apple-system,BlinkMacSystemFont,
         "Segoe UI",Roboto,Ubuntu,Arial,sans-serif;
}
*{box-sizing:border-box}
html,body{
  margin:0;padding:0;
  width:100%;height:100%;
  background:var(--bg);
  color:var(--fg);
  font-family:var(--font);
  overflow:hidden;
}
canvas{position:fixed;inset:0;z-index:0}

/* UI */
.ui{position:fixed;inset:0;pointer-events:none;z-index:2}
.top{
  position:absolute;top:1rem;left:50%;
  transform:translateX(-50%);
  font-size:.7rem;letter-spacing:.18em;opacity:.55
}
.bottom{
  position:absolute;bottom:1.6rem;left:50%;
  transform:translateX(-50%);
  text-align:center;font-size:.7rem;line-height:1.6;opacity:.75
}
.mode{margin-top:.4rem;font-size:.6rem;opacity:.5}
.cta{
  pointer-events:auto;margin-top:.8rem;
  padding:.4rem 1.1rem;border:1px solid var(--border);
  background:transparent;color:var(--fg);
  font-size:.65rem;letter-spacing:.12em;cursor:pointer
}
.cta:hover{background:#111}

/* Impulse */
.impulse{
  position:absolute;bottom:5.2rem;left:50%;
  transform:translateX(-50%);
  width:80%;max-width:520px;
  pointer-events:auto;display:none
}
.impulse textarea{
  width:100%;background:transparent;
  border:1px solid var(--border);color:var(--fg);
  padding:.7rem;resize:none;font-size:.8rem;line-height:1.6
}
.impulse textarea:focus{outline:none;border-color:#777}

.footer{
  position:absolute;bottom:.4rem;right:.6rem;
  font-size:.55rem;opacity:.35
}
</style>
</head>

<body>

<canvas id="field"></canvas>

<div class="ui">
  <div class="top">VECTAETOS © — epistemic field</div>

  <div class="impulse" id="impulseBox">
    <textarea id="impulseInput" rows="3"
      placeholder="Formuluj impulz. Odpoveď nebude textová. (Ctrl + Enter)"></textarea>
  </div>

  <div class="bottom">
    <div>
      Tento priestor neponúka odpovede.<br>
      Ukazuje dôsledky otázok.
    </div>
    <button class="cta" id="supportBtn">Podporiť pole</button>
    <div class="mode" id="modeInfo">MODE: OBSERVE</div>
  </div>

  <div class="footer">© 2026 Richard Fonfára</div>
</div>

<script>
/* =========================================================
   FIELD MODE (PAYWALL AS STATE)
   ========================================================= */
let FIELD_MODE = localStorage.getItem("vectaetos_mode") || "OBSERVE";

const canvas = document.getElementById("field");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize",resize);
resize();

const impulseBox = document.getElementById("impulseBox");
const modeInfo   = document.getElementById("modeInfo");
const supportBtn = document.getElementById("supportBtn");

function updateModeUI(){
  modeInfo.textContent = "MODE: " + FIELD_MODE;
  impulseBox.style.display = FIELD_MODE==="IMPULSE" ? "block":"none";
  supportBtn.style.display = FIELD_MODE==="IMPULSE" ? "none":"inline-block";
}
updateModeUI();

supportBtn.onclick = ()=>{
  FIELD_MODE="IMPULSE";
  localStorage.setItem("vectaetos_mode","IMPULSE");
  updateModeUI();
};

/* =========================================================
   AXIOMATIC ORIENTATIONS Σ₁…Σ₈
   (with basal tension = field exists)
   ========================================================= */
const AXIOMS=[
  {id:"INT",angle:0,tension:.08},
  {id:"LEX",angle:Math.PI/4,tension:.06},
  {id:"VER",angle:Math.PI/2,tension:.07},
  {id:"LIB",angle:3*Math.PI/4,tension:.05},
  {id:"UNI",angle:Math.PI,tension:.06},
  {id:"REL",angle:5*Math.PI/4,tension:.07},
  {id:"WIS",angle:3*Math.PI/2,tension:.05},
  {id:"CRE",angle:7*Math.PI/4,tension:.06}
];

/* =========================================================
   IMPULSE → TENSION
   ========================================================= */
function generateImpulse(text){
  const len=text.length;
  const entropy=new Set(text).size/Math.max(1,len);
  return{
    magnitude:Math.min(1,len/120),
    direction:(entropy*Math.PI*2)%(Math.PI*2)
  };
}
function applyImpulse(imp){
  AXIOMS.forEach(a=>{
    const delta=Math.abs(
      Math.atan2(
        Math.sin(imp.direction-a.angle),
        Math.cos(imp.direction-a.angle)
      )
    );
    a.tension += imp.magnitude*Math.max(0,1-delta/Math.PI);
    a.tension=Math.min(a.tension,.6);
  });
}

/* =========================================================
   RENDER LOOP — RELATIONAL TENSION FIELD
   ========================================================= */
function drawField(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  const cx=canvas.width/2;
  const cy=canvas.height/2;
  const R=Math.min(cx,cy)*0.55;

  for(let i=0;i<AXIOMS.length;i++){
    for(let j=i+1;j<AXIOMS.length;j++){
      const a=AXIOMS[i], b=AXIOMS[j];
      const t=(a.tension+b.tension)/2;
      if(t<0.02) continue;

      const ax=cx+Math.cos(a.angle)*R;
      const ay=cy+Math.sin(a.angle)*R;
      const bx=cx+Math.cos(b.angle)*R;
      const by=cy+Math.sin(b.angle)*R;

      const mx=(ax+bx)/2 + Math.sin(t*6)*R*0.18*t;
      const my=(ay+by)/2 - Math.cos(t*6)*R*0.18*t;

      ctx.beginPath();
      ctx.moveTo(ax,ay);
      ctx.quadraticCurveTo(mx,my,bx,by);
      ctx.strokeStyle=`rgba(255,255,255,${0.12+t*0.65})`;
      ctx.lineWidth=0.5+t*2;
      ctx.stroke();
    }
  }

  /* Entropic return + autonomous drift */
  AXIOMS.forEach(a=>{
    a.tension*=0.985;
    a.tension+=(Math.random()-.5)*0.002;
    a.tension=Math.max(.02,Math.min(.12,a.tension));
  });

  requestAnimationFrame(drawField);
}
drawField();

/* =========================================================
   INPUT (IMPULSE ONLY)
   ========================================================= */
const impulseInput=document.getElementById("impulseInput");
impulseInput.addEventListener("keydown",e=>{
  if(e.key==="Enter" && e.ctrlKey && FIELD_MODE==="IMPULSE"){
    const text=impulseInput.value.trim();
    impulseInput.value="";
    if(text) applyImpulse(generateImpulse(text));
  }
});
</script>

</body>
</html>
