<!DOCTYPE html>
<html lang="sk">
<head>
<meta charset="UTF-8">
<title>VECTAETOS © — epistemic field</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html,body{
  margin:0; padding:0;
  width:100%; height:100%;
  background:#000; overflow:hidden;
  font-family:system-ui,sans-serif;
  color:#aaa;
}
canvas{display:block}

#title{
  position:fixed; top:14px; width:100%;
  text-align:center; font-size:13px;
  letter-spacing:.2em; opacity:.6;
  pointer-events:none;
}
#ask{
  position:fixed; bottom:68px; left:50%;
  transform:translateX(-50%);
  width:90%; max-width:520px;
  padding:14px;
  background:rgba(255,255,255,.06);
  color:#eee;
  border:1px solid rgba(255,255,255,.2);
  outline:none; font-size:14px;
}
#hint{
  position:fixed; bottom:38px; width:100%;
  text-align:center; font-size:12px; opacity:.55;
  pointer-events:none;
}
#mode{
  position:fixed; bottom:18px; width:100%;
  text-align:center; font-size:11px; opacity:.35;
  pointer-events:none;
}
</style>
</head>

<body>
<div id="title">VECTAETOS © — epistemic field</div>
<canvas id="field"></canvas>

<input id="ask" placeholder="Formuluj impulz. Odpoveď nebude textová. (Ctrl + Enter)">
<div id="hint">Tento priestor neposkytuje odpovede. Ukazuje dôsledky otázok.</div>
<div id="mode">MODE: IMPULSE</div>

<script>
/* ================== SETUP ================== */
const canvas=document.getElementById("field");
const ctx=canvas.getContext("2d");
function resize(){
  const dpr=window.devicePixelRatio||1;
  canvas.width=innerWidth*dpr;
  canvas.height=innerHeight*dpr;
  canvas.style.width=innerWidth+"px";
  canvas.style.height=innerHeight+"px";
  ctx.setTransform(dpr,0,0,dpr,0,0);
}
addEventListener("resize",resize);
resize();

/* ================== AXIOMS Σ₁…Σ₈ ================== */
const AXIOMS=[
  "INT","LEX","VER","LIB","UNI","REL","WIS","CRE"
].map((id,i)=>({
  id,
  angle:(Math.PI*2/8)*i,
  tension:0.08,
  phase:Math.random()*Math.PI*2,
  velocity:0
}));

/* ================== IMPULSE PROJECTION ================== */
/* čisto symbolická projekcia textu → 8 napätí */
function projectImpulse(text){
  const v=new Array(8).fill(0);
  for(let i=0;i<text.length;i++){
    v[i%8]+= (text.charCodeAt(i)%13)/13;
  }
  const max=Math.max(...v)||1;
  return v.map(x=>x/max);
}

/* ================== INPUT ================== */
document.getElementById("ask").addEventListener("keydown",e=>{
  if(e.key==="Enter" && e.ctrlKey){
    const text=e.target.value.trim();
    if(!text) return;
    const p=projectImpulse(text);
    AXIOMS.forEach((a,i)=>{
      a.velocity += 0.15*p[i];
    });
    e.target.value="";
  }
});

/* ================== DRAW LOOP ================== */
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  const cx=innerWidth/2;
  const cy=innerHeight/2;
  const R=Math.min(cx,cy)*0.55;

  /* aktualizácia dynamiky */
  AXIOMS.forEach(a=>{
    a.phase += 0.01 + a.velocity;
    a.tension += Math.sin(a.phase)*0.001 + a.velocity*0.02;
    a.velocity *= 0.9;
    a.tension=Math.max(0.03,Math.min(0.35,a.tension));
  });

  /* kreslenie tenzií */
  for(let i=0;i<AXIOMS.length;i++){
    for(let j=i+1;j<AXIOMS.length;j++){
      const A=AXIOMS[i], B=AXIOMS[j];
      const t=(A.tension+B.tension)/2;
      if(t<0.05) continue;

      const ax=cx+Math.cos(A.angle)*R;
      const ay=cy+Math.sin(A.angle)*R;
      const bx=cx+Math.cos(B.angle)*R;
      const by=cy+Math.sin(B.angle)*R;

      const warp=Math.sin(A.phase+B.phase)*R*0.25*t;
      const mx=(ax+bx)/2 + Math.cos(A.angle)*warp;
      const my=(ay+by)/2 + Math.sin(B.angle)*warp;

      ctx.beginPath();
      ctx.moveTo(ax,ay);
      ctx.quadraticCurveTo(mx,my,bx,by);

      ctx.strokeStyle=`rgba(160,200,255,${0.25+t})`;
      ctx.lineWidth=1.2 + t*3.5;   // MOBILE FIX
      ctx.stroke();
    }
  }

  requestAnimationFrame(draw);
}
draw();
</script>
</body>
</html>
